# MPC

## 加入了约束，用来约束控制输入的大小
参考官方文档，在quadprog()的第3,4个参数分别代表约束 $aX≤b$中的 $a$和 $b$，这里我们仅对**优化后需要取出来的控制器输入维数**进行约束，如对p维控制器 $u$进行N步预测，要求约束控制器
$$-100\leq u \leq 100 $$
那么可以拆解为  

$$ -u \leq 100 $$  

对应 $a$矩阵部分应该是p维的负单位对角矩阵然后垂直并上全0矩阵的扩展矩阵  
对应 $b$向量部分应该是p维元素为100的向量垂直并上p*(N-1)维的任意向量  

$$  u \leq 100 $$   

对应 $a$矩阵部分应该是p维的单位对角矩阵然后垂直并上全0矩阵的扩展矩阵  
对应 $b$向量部分应该是p维元素为100的向量垂直并上p*(N-1)维的任意向量  


## 测试

### 无约束
误差  

![image](https://github.com/Tor1yung/MPC/assets/127203005/007f10fe-807f-48b5-9f61-54be082d91a4)  

控制器  (ps:不要在意legend写错了)

![image](https://github.com/Tor1yung/MPC/assets/127203005/45a87530-badb-417c-a4f2-4b9c0b5560ce)  

可以看到开头控制器有个很大飙升，我们尝试把其压低  

### 控制器输入约束在250内  
误差  

![image](https://github.com/Tor1yung/MPC/assets/127203005/4b101ad9-fba7-4041-a301-be6dbb4faa80)  

控制器  

![image](https://github.com/Tor1yung/MPC/assets/127203005/e9c41988-5e12-4e09-9dc2-7a6babae02d4)  

可以看到控制器大小被压制下来，但明显由于开头输入不足，误差也会有所妥协
